/**
 *	klr
 *
 *	@version 1.1
 *	@author Alexandre Masy
 *	@link http://github.com/ahsx/klr
 **/
(function(window){var klrtool=function(){};klrtool.hexToRGB=function(hex){if(typeof hex=="string")hex=hex.indexOf("#")==0?hex.substr(1):hex;if(typeof hex!="number")hex=parseInt(hex,16);var ret={};ret.red=hex>>16&255;ret.green=hex>>8&255;ret.blue=hex&255;return ret};klrtool.RGBToHex=function(red,green,blue){return red<<16|green<<8|blue|0};klrtool.HSVToRGB=function(h,s,v){s=s/100;v=v/100;var i,f,p,q,t,red=0,green=0,blue=0;var ret;if(s==0){red=green=blue=v;ret={red:Math.round(red*255),green:Math.round(green*
255),blue:Math.round(blue*255)};return ret}if(h>360)h=h-360;if(h<0)h=360+h;h=h/60;i=Math.floor(h);f=h-i;p=v*(1-s);q=v*(1-s*f);t=v*(1-s*(1-f));switch(i){case 0:red=v;green=t;blue=p;break;case 1:red=q;green=v;blue=p;break;case 2:red=p;green=v;blue=t;break;case 3:red=p;green=q;blue=v;break;case 4:red=t;green=p;blue=v;break;default:red=v;green=p;blue=q;break}ret={red:Math.round(red*255),green:Math.round(green*255),blue:Math.round(blue*255)};return ret};klrtool.RGBToHSV=function(red,green,blue){red/=255,
green/=255,blue/=255;var min,max,delta,h,s;var ret={};min=Math.min(red,green,blue);max=Math.max(red,green,blue);var v=max;delta=max-min;if(max!=0)s=delta/max;else{s=0;h=-1;ret.hue=h|0;ret.saturation=s*100|0;ret.value=v|0;return ret}if(red==max)h=(green-blue)/delta;else if(green==max)h=2+(blue-red)/delta;else h=4+(red-green)/delta;h*=60;if(h<0)h+=360;ret.hue=Math.round(h);ret.saturation=Math.round(s*100);ret.value=Math.round(v*100);return ret};klrtool.RGBToHSL=klrtool.RGBToHSB=function(red,green,blue){red/=
255,green/=255,blue/=255;var max=Math.max(red,green,blue),min=Math.min(red,green,blue);var h,s,l=(max+min)/2;if(max==min)h=s=0;else{var d=max-min;s=l>0.5?d/(2-max-min):d/(max+min);if(red==max)h=(green-blue)/d;else if(green==max)h=2+(blue-red)/d;else h=4+(red-green)/d;h*=60;if(h<0)h+=360}ret={hue:Math.round(h),saturation:Math.round(s*100),brightness:Math.round(l*100)};return ret};window.klrtool=klrtool})(window);(function(window){var klr=function(red,green,blue){this.initialize(red,green,blue)};klr.fromHex=function(hex){var rgb=klrtool.hexToRGB(hex);var ret=new klr(rgb.red,rgb.green,rgb.blue);return ret};var p=klr.prototype;p._red=null;p._blue=null;p._green=null;p._originalRed=null;p._originalBlue=null;p._originalGreen=null;p.initialize=function(red,green,blue){this._red=red|0;this._green=green|0;this._blue=blue|0};p.reset=function(){this._red=this._originalRed;this._blue=this._originalBlue;this._green=this._originalGreen};
p.getRed=function(){return this._red};p.getGreen=function(){return this._green};p.getBlue=function(){return this._blue};p.setBrightness=function(amount){amount=Math.max(0,Math.min(100,amount));var hsv=klrtool.RGBToHSV(this._red,this._green,this._blue);var result=klrtool.HSVToRGB(hsv.hue,hsv.saturation,amount);this._red=result.red;this._green=result.green;this._blue=result.blue};p.getBrightness=function(){var hsv=klrtool.RGBToHSV(this._red,this._green,this._blue);return hsv.value};p.setSaturation=
function(amount){amount=Math.max(0,Math.min(100,amount));var hsv=klrtool.RGBToHSV(this._red,this._green,this._blue);var result=klrtool.HSVToRGB(hsv.hue,amount,hsv.value);this._red=result.red;this._green=result.green;this._blue=result.blue};p.getSaturation=function(){var hsv=klrtool.RGBToHSV(this._red,this._green,this._blue);return hsv.saturation};p.setHue=function(amount){amount=Math.max(0,Math.min(360,amount));var hsv=klrtool.RGBToHSV(this._red,this._green,this._blue);var result=klrtool.HSVToRGB(amount,
hsv.saturation,hsv.value);this._red=result.red;this._green=result.green;this._blue=result.blue};p.getHue=function(){var hsv=klrtool.RGBToHSV(this._red,this._green,this._blue);return hsv.hue};p.format=function(value){var ret;switch(value){case "hex":default:ret=klrtool.RGBToHex(this._red,this._green,this._blue);break;case "rgb":ret="rgb("+this._red+","+this._green+","+this._blue+")";break;case "rgba":ret="rgb("+this._red+","+this._green+","+this._blue+",1)";break;case "string":ret=klrtool.RGBToHex(this._red,
this._green,this._blue).toString(16);break;case "hsl":case "hsla":case "hsv":console.log("format not implemented");break}return ret};p.getOriginalHex=function(){return klrtool.RGBToHex(this._originalRed,this._originalGreen,this._originalBlue)};p.rgbComplement=function(){return this.rgbRotate(180)};p.rybComplement=function(){return this.rybRotate(180)};p.rgbRotate=function(angle){var hsv=klrtool.RGBToHSV(this._red,this._green,this._blue);var rgb=klrtool.HSVToRGB(hsv.hue-angle,hsv.saturation,hsv.value);
return new klr(rgb.red,rgb.green,rgb.blue)};p.rybRotate=function(angle){var rybWheel=[[0,0],[15,8],[30,17],[45,26],[60,34],[75,41],[90,48],[105,54],[120,60],[135,81],[150,103],[165,123],[180,138],[195,155],[210,171],[225,187],[240,204],[255,219],[270,234],[285,251],[300,267],[315,282],[330,298],[345,329],[360,0]];var hsv=klrtool.RGBToHSV(this._red,this._green,this._blue);var a;for(var i=0;i<rybWheel.length;i++){var x0=rybWheel[i][0];var y0=rybWheel[i][1];var x1=rybWheel[i+1][0];var y1=rybWheel[i+
1][1];if(y1<y0)y1+=360;if(y0<=hsv.hue&&hsv.hue<=y1){a=1*x0+(x1-x0)*(hsv.hue-y0)/(y1-y0);break}}a=a+angle%360;if(a<0)a=360+a;if(a>360)a=a-360;a=a%360;var newHue;for(var k=0;k<rybWheel.length;k++){var xx0=rybWheel[k][0];var yy0=rybWheel[k][1];var xx1=rybWheel[k+1][0];var yy1=rybWheel[k+1][1];if(yy1<yy0)yy1+=360;if(xx0<=a&&a<=xx1){newHue=1*yy0+(yy1-yy0)*(a-xx0)/(xx1-xx0);break}}newHue=newHue%360;var rgb=klrtool.HSVToRGB(newHue,hsv.saturation,hsv.value);return new klr(rgb.red,rgb.green,rgb.blue)};p.toComplementList=
function(){var wheel=new klrlist(this.copy());wheel.addColor(this.rybComplement());return wheel};p.toSplitComplementList=function(){var wheel=new klrlist(this.copy());var one=this.rybComplement().rybRotate(-30);var two=this.rybComplement().rybRotate(30);one.setBrightness(one.getBrightness()+10);two.setBrightness(10);wheel.addColor(one);wheel.addColor(two);return wheel};p.toComplementaryList=function(){var wheel=new klrlist;wheel.addColor(this.copy());var contrasting=this.copy();if(this.getBrightness()>
40)contrasting.setBrightness(10+this.getBrightness()*0.25);else contrasting.setBrightness(100-this.getBrightness()*0.25);wheel.addColor(contrasting);var supporting=this.copy();supporting.setBrightness(30+this.getBrightness());supporting.setSaturation(10+this.getSaturation()*0.3);wheel.addColor(supporting);var complement=this.rybComplement();wheel.addColor(complement);var contrastingComplement=complement.copy();if(complement.getBrightness()>30)contrastingComplement.setBrightness(10+complement.getBrightness()*
0.25);else contrastingComplement.setBrightness(100-complement.getBrightness()*0.25);wheel.addColor(contrastingComplement);var supportingComplement=complement.copy();supportingComplement.setBrightness(30+complement.getBrightness());supportingComplement.setSaturation(10+complement.getSaturation()*0.3);wheel.addColor(supportingComplement);return wheel};p.toLeftComplementaryList=function(){var wheel=this.toComplementaryList();var left=this.toSplitComplementList().getList()[1];var colors=wheel.getList();
colors[3].setHue(left.getHue());colors[4].setHue(left.getHue());colors[5].setHue(left.getHue());return wheel};p.toRightComplementaryList=function(){var wheel=this.toComplementaryList();var right=this.toSplitComplementList().getList()[2];var colors=wheel.getList();colors[3].setHue(right.getHue());colors[4].setHue(right.getHue());colors[5].setHue(right.getHue());return wheel};p.toMonochrome=function(){var wheel=new klrlist(this.copy());var c1=this.copy();c1.setBrightness(this.wrap(this.getBrightness(),
50,20,30));c1.setSaturation(this.wrap(this.getSaturation(),30,10,20));wheel.addColor(c1);var c2=this.copy();c2.setBrightness(this.wrap(this.getBrightness(),20,20,60));wheel.addColor(c2);var c3=this.copy();c3.setBrightness(Math.max(20,this.getBrightness()+(100-this.getBrightness())*0.2));c3.setSaturation(this.wrap(this.getSaturation(),30,10,30));wheel.addColor(c3);var c4=this.copy();c4.setBrightness(this.wrap(this.getBrightness(),50,20,30));wheel.addColor(c4);return wheel};p.toTriad=function(angle){angle=
angle||120;var wheel=new klrlist(this.copy());var color1=this.rybRotate(angle);color1.brighten(10);wheel.addColor(color1);var color2=this.rybRotate(-angle);color2.brighten(10);wheel.addColor(color2);return wheel};p.toTetrad=function(angle){angle=angle||90;var wheel=new klrlist(this.copy());var c1=this.rybRotate(angle);if(this.getBlue()<50)c1.setBrightness(c1.getBrightness()+20);else c1.setBrightness(c1.getBrightness()-20);wheel.addColor(c1);var c2=this.rybRotate(angle*2);if(this.getBrightness()>50)c2.setBrightness(c2.getBrightness()+
10);else c2.setBrightness(c2.getBrightness()-10);wheel.addColor(c2);var c3=this.rybRotate(angle*3);c3.brighten(10);wheel.addColor(c3);return wheel};p.toAnalogous=function(angle,contrast){angle=angle||10;contrast=contrast||25;contrast=Math.max(0,Math.min(contrast,100));var wheel=new klrlist(this.copy());var array=new Array(new Array(1,2.2),new Array(2,1),new Array(-1,-0.5),new Array(-2,1));for(var i=0;i<array.length;i++){var one=array[i][0];var two=array[i][1];var color=this.rybRotate(angle*one);var t=
0.44-two*0.1;if(this.getBrightness()-contrast*two<t)color.setBrightness(t*100);else color.setBrightness(this.getBrightness()-contrast*two);color.setSaturation(color.getSaturation()-5);wheel.addColor(color)}return wheel};p.toCompound=function(flip){flip=flip||false;var wheel=new klrlist(this.copy());var d=1;if(flip)d=-1;var c1=this.rybRotate(30*d);c1.setBrightness(this.wrap(this.getBrightness(),25,60,25));wheel.addColor(c1);var c2=this.rybRotate(30*d);c2.setBrightness(this.wrap(this.getBrightness(),
40,10,40));c2.setSaturation(this.wrap(this.getSaturation(),40,20,40));wheel.addColor(c2);var c3=this.rybRotate(160*d);c3.setSaturation(this.wrap(this.getSaturation(),25,10,25));c3.setBrightness(Math.max(20,this.getBrightness()));wheel.addColor(c3);var c4=this.rybRotate(150*d);c4.setSaturation(this.wrap(this.getSaturation(),10,80,10));c4.setBrightness(this.wrap(this.getBrightness(),30,60,30));wheel.addColor(c4);var c5=this.rybRotate(150*d);c5.setSaturation(this.wrap(this.getSaturation(),10,80,10));
c5.setBrightness(this.wrap(this.getBrightness(),40,20,40));wheel.addColor(c5);return wheel};p.toLight=function(count){count=count||10;return this.getRange([30,70],[90,100],count)};p.toLightBlack=function(count){count=count||10;return this.getRange([30,70],[15,30],count)};p.toDark=function(count){count=count||10;return this.getRange([70,100],[15,40],count)};p.toDarkWhite=function(count){count=count||10;return this.getRange([70,100],[50,75],count)};p.toBright=function(count){count=count||10;return this.getRange([80,
100],[80,100],count)};p.toWeak=function(count){count=count||10;return this.getRange([15,30],[70,100],count)};p.toWeakBlack=function(count){count=count||10;return this.getRange([15,30],[20,20],count)};p.toNeutral=function(count){count=count||10;return this.getRange([25,35],[30,70],count)};p.toNeutralBlack=function(count){count=count||10;return this.getRange([25,35],[15,15],count)};p.toNeutralWhite=function(count){count=count||10;return this.getRange([25,35],[90,100],count)};p.toFresh=function(count){count=
count||10;return this.getRange([40,80],[80,100],count)};p.toFreshBlack=function(count){count=count||10;return this.getRange([40,80],[5,30],count)};p.toSoft=function(count){count=count||10;return this.getRange([20,30],[60,90],count)};p.toSoftBlack=function(count){count=count||10;return this.getRange([20,30],[5,15],count)};p.toHard=function(count){count=count||10;return this.getRange([90,100],[40,100],count)};p.toWarm=function(count){count=count||10;return this.getRange([60,90],[40,90],count)};p.toWarmWhite=
function(count){count=count||10;return this.getRange([60,90],[80,100],count)};p.toWarmBlack=function(count){count=count||10;return this.getRange([60,90],[20,20],count)};p.toCool=function(count){count=count||10;return this.getRange([5,20],[90,100],count)};p.toCoolWhite=function(count){count=count||10;return this.getRange([5,20],[95,100],count)};p.toIntense=function(count){count=count||10;return this.getRange([90,100],[80,100],count)};p.toIntenseBlack=function(count){count=count||10;return this.getRange([90,
100],[20,35],count)};p.copy=function(){return new klr(this._red,this._green,this._blue)};p.blend=function(otherColor,factor){factor=factor||0.5;var r=Math.max(0,Math.min(256,_red*(1-factor)+otherklr.getRed()*factor));var g=Math.max(0,Math.min(256,_green*(1-factor)+otherklr.getGreen()*factor));var b=Math.max(0,Math.min(256,_blue*(1-factor)+otherklr.getBlue()*factor));return new klr(r,g,b)};p.gradientTo=function(otherColor,steps){steps=steps||20;var wheel=new klrlist(this.copy());steps-=2;var factorStep=
1/steps;for(var i=0;i<steps;i++)wheel.addColor(blend(otherColor,factorStep*i));wheel.addColor(otherColor);return wheel};p.rotateTo=function(otherColor,steps,flip){steps=steps||10;flip=flip||false;var wheel=new klrlist(this.copy());steps-=2;var hue=this.getHue();var sat=this.getSaturation();var brightness=this.getBrightness();var deltaHue=hue-otherklr.getHue();var deltaSat=sat-otherklr.getSaturation();var deltaBrightness=brightness-otherklr.getBrightness();if(deltaHue<0)deltaHue=Math.abs(deltaHue);
else if(deltaHue>360)deltaHue=deltaHue-360;var hueStep=deltaHue/steps;var satStep=deltaSat/steps;var brightnessStep=deltaBrightness/steps;var direction=-1;if(flip)direction=1;for(var i=0;i<steps;i++){var rgb=klrtool.convertHSVToRGB(hue+direction*i*hueStep,sat-satStep*i,brightness-brightnessStep*i);var c=new klr(rgb[0],rgb[1],rgb[2]);wheel.addColor(c)}wheel.addColor(otherklr.copy());return wheel};p.getRange=function(saturation,brightness,count){var wheel=new klrlist;for(var i=0;i<count;i++){var theSat=
Math.random()*(saturation[1]-saturation[0])+saturation[0];var theBright=Math.random()*(brightness[1]-brightness[0])+brightness[0];var newklr=this.copy();newklr.setSaturation(theSat);newklr.setBrightness(theBright);if(!wheel.contains(newklr))wheel.addColor(newklr)}return wheel};p.getFullRange=function(color,saturation,brightness,count){count=count||20;var wheel=new klrlist;for(var i=0;i<count;i++){var theSat=Math.random()*(saturation[1]-saturation[0])+saturation[0];var theBright=Math.random()*(brightness[1]-
brightness[0])+brightness[0];var red=Math.abs(Math.random()*(color[1][0]-color[0][0])+color[0][0]);var green=Math.abs(Math.random()*(color[1][1]-color[0][1])+color[0][1]);var blue=Math.abs(Math.random()*(color[1][2]-color[0][2])+color[0][2]);var newklr=new klr(red,green,blue);newklr.setSaturation(theSat);newklr.setBrightness(theBright);if(!wheel.contains(newklr))wheel.addColor(newklr)}return wheel};p.isEqual=function(otherklr){var result=false;if(otherklr.getRed()==this._red&&otherklr.getBlue()==
this._blue&&otherklr.getGreen()==this._green)result=true;return result};p.wrap=function(x,min,threshold,plus){var result=0;if(x-min<threshold)result=x+plus;else result=x-min;return result};p.brighten=function(amount){this.setBrightness(Math.min(100,this.getBrightness()+amount))};p.darken=function(amount){this.setBrightness(Math.max(0,this.getBrightness()-amount))};p.saturate=function(amount){this.setSaturation(this.getSaturation()+amount)};p.deSaturate=function(amount){this.setSaturation(this.getSaturation()-
amount)};window.klr=klr})(window);(function(){klrlist=function(first){this.init(first)};var p=klrlist.prototype;p.init=function(first){this.list=[];this.index=0;if(first!=null)this.addColor(first)};p.addColor=function(color){this.list.push(color)};p.getColor=function(index){index=index||this.index;var ret=this.list[index];this.rotate();return ret};p.getList=function(){return this.list};p.rotate=function(){if(this.index==this.list.length-1)this.index=0;else this.index++};p.brighten=function(amount){amount=amount||10;var n=this.list.length-
1,i=-1,color;while(i++<n){color=this.list[i];color.brighten(amount)}};p.darken=function(amount){amount=amount||10;var n=this.list.length-1,i=-1,color;while(i++<n){color=this.list[i];color.darken(amount)}};p.saturate=function(amount){amount=amount||10;var n=this.list.length-1,i=-1,color;while(i++<n){color=this.list[i];color.saturate(amount)}};p.deSaturate=function(amount){amount=amount||10;var n=this.list.length-1,i=-1,color;while(i++<n){color=this.list[i];color.deSaturate(amount)}};p.copy=function(){var newWheel=
new klrlist;var n=this.list.length-1,i=-1,color;while(i++<n){color=this.list[i];newWheel.addColor(color.copy())}return newWheel};p.contains=function(newColor){var n=this.list.length-1,i=-1,color;var ret=false;while(i++<n){color=this.list[i];if(color.isEqual(newColor))ret=true}return ret};p.mix=function(second){var cw2=second.getList();var n=cw2.length-1,i=-1;while(i++<n)this.addColor(cw2[i])};p.shuffle=function(){this.list.sort(onShuffle)};p.sortByBrightness=function(){this.list.sort(onBrightness)};
p.sortBySaturation=function(){this.list.sort(onSaturation)};p.sortByHue=function(){this.list.sort(onHue)};function onHue(c1,c2){var ret=-1;if(c1.getHue()>c2.getHue())ret=-1;else if(c1.getHue()==c2.getHue())ret=0;else if(c1.getHue()<c2.getHue())ret=1;return-1}function onSaturation(c1,c2){var ret=-1;if(c1.getSaturation()>c2.getSaturation())ret=-1;else if(c1.getSaturation()==c2.getSaturation())ret=0;else if(c1.getSaturation()<c2.getSaturation())ret=1;return ret}function onShuffle(ob1,ob2){var ret=-1;
var rnd=Math.random()*1.2-0.6;if(rnd<0.2&&rnd>-0.2)ret=0;if(rnd>0.2)ret=1;if(rnd<-0.2)ret=-1;return ret}function onBrightness(c1,c2){var ret=-1;if(c1.getBrightness()>c2.getBrightness())ret=-1;else if(c1.getBrightness()==c2.getBrightness())ret=0;else if(c1.getBrightness()<c2.getBrightness())ret=1;return ret}p.length=function(){return this.list.length};window.klrlist=klrlist})(window);
